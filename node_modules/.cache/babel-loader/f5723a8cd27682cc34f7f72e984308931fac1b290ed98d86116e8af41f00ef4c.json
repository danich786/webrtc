{"ast":null,"code":"import _classCallCheck from\"/Users/Dani/Desktop/webrtc/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/Dani/Desktop/webrtc/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/Dani/Desktop/webrtc/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/Dani/Desktop/webrtc/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);// https://reactjs.org/docs/refs-and-the-dom.html\n_this.componentDidMount=function(){var pc_config=null;// const pc_config1 = {\n//   \"iceServers\": [\n//     {\n//       urls: 'stun:[STUN_IP]:[PORT]',\n//       'credentials': '[YOR CREDENTIALS]',\n//       'username': '[USERNAME]'\n//     }\n//   ]\n// }\n// https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection\n// create an instance of RTCPeerConnection\n_this.pc=new RTCPeerConnection(pc_config);// triggered when a new candidate is returned\n_this.pc.onicecandidate=function(e){// send the candidates to the remote peer\n// see addCandidate below to be triggered on the remote peer\nif(e.candidate)console.log(JSON.stringify(e.candidate));};// triggered when there is a change in connection state\n_this.pc.oniceconnectionstatechange=function(e){console.log(e);};// triggered when a stream is added to pc, see below - this.pc.addStream(stream)\n// this.pc.onaddstream = (e) => {\n//   this.remoteVideoref.current.srcObject = e.stream\n// }\n_this.pc.ontrack=function(e){_this.remoteVideoref.current.srcObject=e.streams[0];};// called when getUserMedia() successfully returns - see below\n// getUserMedia() returns a MediaStream object (https://developer.mozilla.org/en-US/docs/Web/API/MediaStream)\nvar success=function success(stream){window.localStream=stream;_this.localVideoref.current.srcObject=stream;_this.pc.addStream(stream);};// called when getUserMedia() fails - see below\nvar failure=function failure(e){console.log('getUserMedia Error: ',e);};// https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n// see the above link for more constraint options\nvar constraints={audio:false,video:true// video: {\n//   width: 1280,\n//   height: 720\n// },\n// video: {\n//   width: { min: 1280 },\n// }\n};// https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\nnavigator.mediaDevices.getUserMedia(constraints).then(success).catch(failure);};/* ACTION METHODS FROM THE BUTTONS ON SCREEN */_this.createOffer=function(){console.log('Offer');// https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createOffer\n// initiates the creation of SDP\n_this.pc.createOffer({offerToReceiveVideo:1}).then(function(sdp){console.log(JSON.stringify(sdp));// set offer sdp as local description\n_this.pc.setLocalDescription(sdp);});};// https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createAnswer\n// creates an SDP answer to an offer received from remote peer\n_this.createAnswer=function(){console.log('Answer');_this.pc.createAnswer({offerToReceiveVideo:1}).then(function(sdp){console.log(JSON.stringify(sdp));// set answer sdp as local description\n_this.pc.setLocalDescription(sdp);});};_this.setRemoteDescription=function(){// retrieve and parse the SDP copied from the remote peer\nvar desc=JSON.parse(_this.textref.value);// set sdp as remote description\n_this.pc.setRemoteDescription(new RTCSessionDescription(desc));};_this.addCandidate=function(){// retrieve and parse the Candidate copied from the remote peer\nvar candidate=JSON.parse(_this.textref.value);console.log('Adding candidate:',candidate);// add the candidate to the peer connection\n_this.pc.addIceCandidate(new RTCIceCandidate(candidate));};_this.localVideoref=/*#__PURE__*/React.createRef();_this.remoteVideoref=/*#__PURE__*/React.createRef();return _this;}_createClass(App,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"video\",{style:{width:240,height:240,margin:5,backgroundColor:'black'},ref:this.localVideoref,autoPlay:true}),/*#__PURE__*/_jsx(\"video\",{style:{width:240,height:240,margin:5,backgroundColor:'black'},ref:this.remoteVideoref,autoPlay:true}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:this.createOffer,children:\"Offer\"}),/*#__PURE__*/_jsx(\"button\",{onClick:this.createAnswer,children:\"Answer\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"textarea\",{ref:function ref(_ref){_this2.textref=_ref;}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{onClick:this.setRemoteDescription,children:\"Set Remote Desc\"}),/*#__PURE__*/_jsx(\"button\",{onClick:this.addCandidate,children:\"Add Candidate\"})]});}}]);return App;}(Component);export default App;","map":{"version":3,"names":["React","Component","jsx","_jsx","jsxs","_jsxs","App","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","componentDidMount","pc_config","pc","RTCPeerConnection","onicecandidate","e","candidate","console","log","JSON","stringify","oniceconnectionstatechange","ontrack","remoteVideoref","current","srcObject","streams","success","stream","window","localStream","localVideoref","addStream","failure","constraints","audio","video","navigator","mediaDevices","getUserMedia","then","catch","createOffer","offerToReceiveVideo","sdp","setLocalDescription","createAnswer","setRemoteDescription","desc","parse","textref","value","RTCSessionDescription","addCandidate","addIceCandidate","RTCIceCandidate","createRef","_createClass","key","render","_this2","children","style","width","height","margin","backgroundColor","ref","autoPlay","onClick"],"sources":["/Users/Dani/Desktop/webrtc/src/App.js"],"sourcesContent":["import React, { Component } from 'react';\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    // https://reactjs.org/docs/refs-and-the-dom.html\n    this.localVideoref = React.createRef()\n    this.remoteVideoref = React.createRef()\n  }\n\n  componentDidMount = () => {\n\n    const pc_config = null\n\n    // const pc_config1 = {\n    //   \"iceServers\": [\n    //     {\n    //       urls: 'stun:[STUN_IP]:[PORT]',\n    //       'credentials': '[YOR CREDENTIALS]',\n    //       'username': '[USERNAME]'\n    //     }\n    //   ]\n    // }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection\n    // create an instance of RTCPeerConnection\n    this.pc = new RTCPeerConnection(pc_config)\n\n    // triggered when a new candidate is returned\n    this.pc.onicecandidate = (e) => {\n      // send the candidates to the remote peer\n      // see addCandidate below to be triggered on the remote peer\n      if (e.candidate)\n        console.log(JSON.stringify(e.candidate))\n    }\n\n    // triggered when there is a change in connection state\n    this.pc.oniceconnectionstatechange = (e) => {\n      console.log(e)\n    }\n\n    // triggered when a stream is added to pc, see below - this.pc.addStream(stream)\n    // this.pc.onaddstream = (e) => {\n    //   this.remoteVideoref.current.srcObject = e.stream\n    // }\n\n    this.pc.ontrack = (e) => {\n      this.remoteVideoref.current.srcObject = e.streams[0]\n    }\n\n    // called when getUserMedia() successfully returns - see below\n    // getUserMedia() returns a MediaStream object (https://developer.mozilla.org/en-US/docs/Web/API/MediaStream)\n    const success = (stream) => {\n      window.localStream = stream\n      this.localVideoref.current.srcObject = stream\n      this.pc.addStream(stream)\n    }\n\n    // called when getUserMedia() fails - see below\n    const failure = (e) => {\n      console.log('getUserMedia Error: ', e)\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n    // see the above link for more constraint options\n    const constraints = {\n      audio: false,\n      video: true,\n      // video: {\n      //   width: 1280,\n      //   height: 720\n      // },\n      // video: {\n      //   width: { min: 1280 },\n      // }\n    }\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n    navigator.mediaDevices.getUserMedia(constraints)\n      .then(success)\n      .catch(failure)\n  }\n\n  /* ACTION METHODS FROM THE BUTTONS ON SCREEN */\n\n  createOffer = () => {\n    console.log('Offer')\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createOffer\n    // initiates the creation of SDP\n    this.pc.createOffer({ offerToReceiveVideo: 1 })\n      .then(sdp => {\n        console.log(JSON.stringify(sdp))\n\n        // set offer sdp as local description\n        this.pc.setLocalDescription(sdp)\n    })\n  }\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createAnswer\n  // creates an SDP answer to an offer received from remote peer\n  createAnswer = () => {\n    console.log('Answer')\n    this.pc.createAnswer({ offerToReceiveVideo: 1 })\n      .then(sdp => {\n        console.log(JSON.stringify(sdp))\n\n        // set answer sdp as local description\n        this.pc.setLocalDescription(sdp)\n    })\n  }\n\n  setRemoteDescription = () => {\n    // retrieve and parse the SDP copied from the remote peer\n    const desc = JSON.parse(this.textref.value)\n\n    // set sdp as remote description\n    this.pc.setRemoteDescription(new RTCSessionDescription(desc))\n  }\n\n  addCandidate = () => {\n    // retrieve and parse the Candidate copied from the remote peer\n    const candidate = JSON.parse(this.textref.value)\n    console.log('Adding candidate:', candidate)\n\n    // add the candidate to the peer connection\n    this.pc.addIceCandidate(new RTCIceCandidate(candidate))\n  }\n\n  render() {\n\n    return (\n      <div>\n        <video\n          style={{\n            width: 240,\n            height: 240,\n            margin: 5,\n            backgroundColor: 'black'\n          }}\n          ref={ this.localVideoref }\n          autoPlay>\n        </video>\n        <video\n          style={{\n            width: 240,\n            height: 240,\n            margin: 5,\n            backgroundColor: 'black'\n          }}\n          ref={ this.remoteVideoref }\n          autoPlay>\n        </video>\n        <br />\n\n        <button onClick={this.createOffer}>Offer</button>\n        <button onClick={this.createAnswer}>Answer</button>\n\n        <br />\n        <textarea ref={ref => { this.textref = ref }} />\n\n        <br />\n        <button onClick={this.setRemoteDescription}>Set Remote Desc</button>\n        <button onClick={this.addCandidate}>Add Candidate</button>\n      </div>\n    )\n  }\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}